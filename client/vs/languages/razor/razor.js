/*---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
"use strict";var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("vs/languages/razor/csharpTokenization",["require","exports","vs/editor/modes/autoIndentation/autoIndentation","vs/base/objects","vs/editor/modes/modes","vs/editor/modes/modesExtensions","vs/languages/html/html","vs/languages/vsxml/vsxml"],function(e,t,r,n,s,o,i,a){var l="+-*%&|^~!=<>/?;:.,",c="+-*/%&|^~!=<>(){}[]\"'\\/?;:.,",u="	 ";t.brackets=new r.Brackets([{tokenType:"delimiter.bracket.cs",open:"{",close:"}",isElectric:!0},{tokenType:"delimiter.array.cs",open:"[",close:"]",isElectric:!0},{tokenType:"delimiter.parenthesis.cs",open:"(",close:")",isElectric:!0},{tokenType:"delimiter.angle.cs",open:"<",close:">",isElectric:!1}]);var d=n.createKeywordMatcher(["abstract","as","async","await","base","bool","break","by","byte","case","catch","char","checked","class","const","continue","decimal","default","delegate","do","double","descending","explicit","event","extern","else","enum","false","finally","fixed","float","for","foreach","from","goto","group","if","implicit","in","int","interface","internal","into","is","lock","long","new","null","namespace","object","operator","out","override","orderby","params","private","protected","public","readonly","ref","return","switch","struct","sbyte","sealed","short","sizeof","stackalloc","static","string","select","this","throw","true","try","typeof","uint","ulong","unchecked","unsafe","ushort","using","var","virtual","volatile","void","while","where","yield","model","inject"]),p=function(e){return l.indexOf(e)>-1},m=function(e){function t(t,r,n){e.call(this,t),this.name=r,this.parent=n}return __extends(t,e),t.prototype.equals=function(r){if(!e.prototype.equals.call(this,r))return!1;var n=r;return r instanceof t&&this.getMode()===n.getMode()&&this.name===n.name&&(null===this.parent&&null===n.parent||null!==this.parent&&this.parent.equals(n.parent))},t.prototype.tokenize=function(e){return e.setTokenRules(c,u),e.skipWhitespace().length>0?{type:""}:this.stateTokenize(e)},t.prototype.stateTokenize=function(){throw new Error("To be implemented")},t}(o.AbstractState);t.CSState=m;var h=function(e){function t(t,r,n){e.call(this,t,"string",r),this.isAtBeginning=!0,this.delimiter=n}return __extends(t,e),t.prototype.makeClone=function(){return new t(this.getMode(),this.parent?this.parent.clone():null,this.delimiter)},t.prototype.equals=function(t){return e.prototype.equals.call(this,t)&&this.delimiter===t.delimiter},t.prototype.tokenize=function(e){var t=this.isAtBeginning?1:0;for(this.isAtBeginning=!1;!e.eos();){var r=e.next();if("\\"===r)return 0===t?e.eos()?{type:"string.escape.cs"}:(e.next(),e.eos()?{type:"string.escape.cs",nextState:this.parent}:{type:"string.escape.cs"}):(e.goBack(1),{type:"string.cs"});if(r===this.delimiter)break;t+=1}return{type:"string.cs",nextState:this.parent}},t}(m),f=function(e){function t(t,r){e.call(this,t,"verbatimstring",r)}return __extends(t,e),t.prototype.makeClone=function(){return new t(this.getMode(),this.parent?this.parent.clone():null)},t.prototype.tokenize=function(e){for(;!e.eos();){var t=e.next();if('"'===t){if(e.eos()||'"'!==e.peek())return{type:"string.cs",nextState:this.parent};e.next()}}return{type:"string.cs"}},t}(m),b=function(e){function t(t,r,n){e.call(this,t,"number",r),this.firstDigit=n}return __extends(t,e),t.prototype.makeClone=function(){return new t(this.getMode(),this.parent?this.parent.clone():null,this.firstDigit)},t.prototype.tokenize=function(e){var t=this.firstDigit,r=10,n=!1,s=!1;if("0"===t&&!e.eos()){if(t=e.peek(),"x"===t)r=16;else{if("."!==t)return{type:"number.cs",nextState:this.parent};r=10}e.next()}for(;!e.eos();)if(t=e.peek(),o.isDigit(t,r))e.next();else{if(10!==r)break;if("."!==t||s||n){if("e"!==t.toLowerCase()||s){if("f"===t.toLowerCase()||"d"===t.toLowerCase()){e.next();break}break}s=!0,e.next(),e.eos()||"-"!==e.peek()||e.next()}else n=!0,e.next()}var i="number";return 16===r&&(i+=".hex"),{type:i+".cs",nextState:this.parent}},t}(m),g=function(e){function t(t,r,n){e.call(this,t,"comment",r),this.commentChar=n}return __extends(t,e),t.prototype.makeClone=function(){return new t(this.getMode(),this.parent?this.parent.clone():null,this.commentChar)},t.prototype.tokenize=function(e){for(;!e.eos();){var t=e.next();if("*"===t&&!e.eos()&&!e.peekWhitespace()&&e.peek()===this.commentChar)return e.next(),{type:"comment.cs",nextState:this.parent}}return{type:"comment.cs"}},t}(m);t.CSComment=g;var v=function(e){function r(t,r,n,s,o,i,l,c){e.call(this,t,"expression",r),this.level=n,this.plevel=s,this.razorMode=o,this.expression=i,this.vsState=new a.VSXMLExpression(t,null),this.firstToken=l,this.firstTokenWasKeyword=c}return __extends(r,e),r.prototype.setVSXMLState=function(e){this.vsState=e},r.prototype.makeClone=function(){var e=new r(this.getMode(),this.parent?this.parent.clone():null,this.level,this.plevel,this.razorMode,this.expression,this.firstToken,this.firstTokenWasKeyword);return null!==this.vsState&&e.setVSXMLState(this.vsState.clone()),e},r.prototype.equals=function(t){return e.prototype.equals.call(this,t)&&t instanceof r&&(null===this.vsState&&null===t.vsState||null!==this.vsState&&this.vsState.equals(t.vsState))},r.prototype.stateTokenize=function(e){if(o.isDigit(e.peek(),10))return this.firstToken=!1,{nextState:new b(this.getMode(),this,e.next())};var r=e.nextToken(),n=!this.firstTokenWasKeyword,s=this.level<=0&&this.plevel<=0&&e.eos()?this.parent:void 0;if(e.eos()&&(this.firstTokenWasKeyword=!1),d(r))return this.level<=0&&(this.expression=!1),this.firstToken&&(this.firstTokenWasKeyword=!0),{type:"keyword.cs"};if(this.firstToken=!1,this.razorMode&&"<"===r&&n&&!e.eos()&&/[_:!\/\w]/.test(e.peek()))return{nextState:new y(this.getMode(),this,i.States.Content)};if(this.razorMode&&this.expression&&this.level<=0&&this.plevel<=0&&!e.eos()&&(/^(\.|\[|\(|\{\w+)$/.test(e.peekToken())||(s=this.parent)),"/"===r){if(!e.eos()&&!e.peekWhitespace())switch(e.peekToken()){case"/":if(e.nextToken(),!e.eos()&&"/"===e.peekToken()){if(e.nextToken(),e.eos())return{type:"comment.vs"};if("/"!==e.peekToken())return{type:"comment.vs",nextState:new a.VSXMLEmbeddedState(this.getMode(),this.vsState,this)}}return e.advanceToEOS(),{type:"comment.cs"};case"*":return e.nextToken(),{nextState:new g(this.getMode(),this,"/")}}return{type:"delimiter.cs",nextState:s}}if("@"===r&&!e.eos())switch(e.peekToken()){case'"':return e.nextToken(),{nextState:new f(this.getMode(),this)};case"*":return e.nextToken(),{nextState:new g(this.getMode(),this,"@")}}if(/@?\w+/.test(r))return{type:"ident.cs",nextState:s};if('"'===r||"'"===r)return{nextState:new h(this.getMode(),this,r)};if(t.brackets.stringIsBracket(r)){var l={bracket:t.brackets.bracketTypeFromString(r),type:t.brackets.tokenTypeFromString(r),nextState:s};return this.razorMode&&("{"===r&&(this.expression=!1,this.level++,1===this.level&&(l.type="metatag.cshtml",l.nextState=void 0)),"}"===r&&(this.level--,this.level<=0&&(l.type="metatag.cshtml",l.nextState=this.parent)),this.expression&&("("===r&&(this.plevel++,1===this.plevel&&(l.type="metatag.cshtml",l.nextState=void 0)),")"===r&&(this.plevel--,this.expression&&this.plevel<=0&&(l.type="metatag.cshtml",l.nextState=this.parent)),"["===r&&(this.plevel++,l.nextState=void 0),"]"===r&&this.plevel--)),l}return p(r)?{type:"delimiter.cs",nextState:s}:this.razorMode&&this.expression&&this.plevel<=0?{type:"",nextState:this.parent}:{type:"",nextState:s}},r}(m);t.CSStatement=v;var w=["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param"],y=function(e){function t(t,r,n){e.call(this,t,"number",r),this.state=n}return __extends(t,e),t.prototype.makeClone=function(){return new t(this.getMode(),this.parent?this.parent.clone():null,this.state)},t.prototype.nextName=function(e){return e.advanceIfRegExp(/^[_:\w][_:\w-.\d]*/)},t.prototype.nextAttrValue=function(e){return e.advanceIfRegExp(/^('|').*?\1/)},t.prototype.tokenize=function(e){switch(this.state){case i.States.WithinComment:if(e.advanceUntil("-->",!1).length>0)return{type:"comment.html.content"};if(e.advanceIfString("-->").length>0)return this.state=i.States.Content,{type:"comment.html",bracket:s.Bracket.Close,nextState:this.parent};break;case i.States.WithinDoctype:if(e.advanceUntil(">",!1).length>0)return{type:"metatag.content.html"};if(e.advanceIfString(">").length>0)return this.state=i.States.Content,{type:"metatag.html",bracket:s.Bracket.Close,nextState:this.parent};break;case i.States.Content:return e.advanceIfString("!--").length>0?(this.state=i.States.WithinComment,{type:"comment.html",bracket:s.Bracket.Open}):e.advanceIfRegExp(/!DOCTYPE/i).length>0?(this.state=i.States.WithinDoctype,{type:"metatag.html",bracket:s.Bracket.Open}):e.advanceIfString("/").length>0?(this.state=i.States.OpeningEndTag,{type:"delimiter.end.html",bracket:s.Bracket.Open}):(this.state=i.States.OpeningStartTag,{type:"delimiter.start.html",bracket:s.Bracket.Open});case i.States.OpeningEndTag:var t=this.nextName(e);return t.length>0?{type:"tag.html.tag-"+t,bracket:-1!==w.indexOf(t)?-1:s.Bracket.Close}:e.advanceIfString(">").length>0?(this.state=i.States.Content,{type:"delimiter.end.html",bracket:s.Bracket.Close,nextState:this.parent}):(e.advanceUntil(">",!1),{type:""});case i.States.OpeningStartTag:var t=this.nextName(e);if(t.length>0)return this.state=i.States.WithinTag,{type:"tag.html.tag-"+t,bracket:-1!==w.indexOf(t)?-1:s.Bracket.Open};break;case i.States.WithinTag:if(e.skipWhitespace().length>0)return{type:""};var r=this.nextName(e);return r.length>0?(this.state=i.States.AttributeName,{type:"attribute.name.html"}):e.advanceIfRegExp(/^\/?>/).length>0?(this.state=i.States.Content,{type:"delimiter.start.html",bracket:s.Bracket.Close,nextState:this.parent}):(e.next(),{type:""});case i.States.AttributeName:return e.skipWhitespace().length>0||e.eos()?{type:""}:"="===e.peek()?(e.next(),this.state=i.States.AttributeValue,{type:""}):(this.state=i.States.WithinTag,this.tokenize(e));case i.States.AttributeValue:if(e.skipWhitespace().length>0||e.eos())return{type:""};var n=this.nextAttrValue(e);return n.length>0?(this.state=i.States.WithinTag,{type:"attribute.value.html"}):(this.state=i.States.WithinTag,this.tokenize(e))}return e.next(),this.state=i.States.Content,{type:"",nextState:this.parent}},t}(m)});var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};define("vs/languages/razor/razor",["require","exports","vs/languages/html/html","vs/languages/razor/csharpTokenization","vs/platform/services"],function(e,t,r,n,s){var o=function(e){function t(t,r,n,s,o,i,a){e.call(this,t,r,n,s,o,i,a)}return __extends(t,e),t.prototype.makeClone=function(){return new t(this.getMode(),this.kind,this.lastTagName,this.lastAttributeName,this.embeddedContentType,this.attributeValueQuote,this.attributeValue)},t.prototype.equals=function(r){return r instanceof t?e.prototype.equals.call(this,r):!1},t.prototype.tokenize=function(t){if(!t.eos()&&"@"===t.peek()){if(t.next(),!t.eos()&&"*"===t.peek())return{nextState:new n.CSComment(this.getMode(),this,"@")};if(t.eos()||"@"!==t.peek())return{type:"metatag.cshtml",nextState:new n.CSStatement(this.getMode(),this,0,0,!0,!0,!0,!1)}}return e.prototype.tokenize.call(this,t)},t}(r.State),i=function(e){function t(t,r){e.call(this,t,r,s.AsyncDescriptor.create("vs/languages/razor/razorWorker","RAZORWorker")),this.formattingSupport=null,this.tokenizationSupport.shouldGenerateEmbeddedModels=!1}return __extends(t,e),t.prototype.getInitialState=function(){return new o(this,r.States.Content,"","","","","")},t.prototype.getLeavingNestedModeData=function(t,n){var s=e.prototype.getLeavingNestedModeData.call(this,t,n);return s&&(s.stateAfterNestedMode=new o(this,r.States.Content,"","","","","")),s},t}(r.HTMLMode);t.RAZORMode=i});