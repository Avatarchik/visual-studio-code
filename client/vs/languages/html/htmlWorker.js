/*---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
define("vs/languages/html/htmlTags",["require","exports","vs/base/strings"],function(e,r,s){function n(){var e=[],r={html:["manifest"],head:e,title:e,noscript:e,section:e,nav:e,article:e,aside:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,hgroup:e,header:e,footer:e,address:e,p:e,hr:e,pre:e,blockquote:["cite"],ol:["reversed:v","start"],ul:e,li:["value"],dl:e,dt:e,dd:e,figure:e,figcaption:e,div:e,a:["href","target","ping","rel","media","hreflang","type"],em:e,strong:e,small:e,s:e,cite:e,q:["cite"],dfn:e,abbr:e,data:["value"],time:["datetime","pubdate"],code:e,var:e,samp:e,kbd:e,sub:e,sup:e,i:e,b:e,u:e,mark:e,ruby:e,rt:e,rp:e,bdi:e,bdo:e,span:e,br:e,wbr:e,ins:["cite","datetime"],del:["cite","datetime"],img:["alt","src","srcset","crossorigin:xo","usemap","ismap:v","width","height"],iframe:["src","srcdoc","name","sandbox","seamless","width","height"],embed:["src","type","width","height"],object:["data","type","typemustmatch:v","name","usemap","form","width","height"],param:["name","value"],video:["src","crossorigin:xo","poster","preload","autoplay:v","mediagroup","loop:v","muted:v","controls:v","width","height"],audio:["src","crossorigin:xo","preload","autoplay:v","mediagroup","loop:v","muted:v","controls:v"],source:["src","type","media"],track:["default:v","kind","label","src","srclang"],canvas:["width","height"],map:["name"],area:["alt","coords","shape","href","target","ping","rel","media","hreflang","type"],base:["href","target"],link:["href","rel","media","hreflang","type","sizes"],meta:["name","http-equiv","content","charset"],style:["media","type","scoped:v"],script:["src","async:v","defer:v","type","charset"],body:["onafterprint","onbeforeprint","onbeforeunload","onblur","onerror","onfocus","onhashchange","onload","onmessage","onoffline","ononline","onpagehide","onpageshow","onpopstate","onresize","onscroll","onstorage","onunload"],table:e,caption:e,colgroup:["span"],col:["span"],tbody:e,thead:e,tfoot:e,tr:e,td:["colspan","rowspan","headers"],th:["colspan","rowspan","headers","scope","abbr"],form:["accept-charset","action","autocomplete:o","enctype","method:m","name","novalidate:v","target"],fieldset:["disabled:v","form","name"],legend:e,label:["form","for"],input:["accept","alt","autocomplete:o","autofocus:v","checked:v","dirname","disabled:v","form","formaction","formenctype","formmethod:m","formnovalidate:v","formtarget","height","inputmode","list","max","maxlength","min","multiple:v","name","pattern","placeholder","readonly:v","required","size","src","step","type:t","value","width"],button:["autofocus:v","disabled:v","form","formaction","formenctype","formmethod:m","formnovalidate:v","formtarget","name","type:bt","value"],select:["autofocus:v","disabled:v","form","multiple:v","name","required:v","size"],datalist:["option"],optgroup:["disabled:v","label"],option:["disabled:v","label","selected:v","value"],textarea:["autocomplete:o","autofocus:v","cols","dirname","disabled:v","form","inputmode","maxlength","name","placeholder","readonly:v","required:v","rows","wrap"],keygen:["autofocus:v","challenge","disabled:v","form","keytype","name"],output:["for","form","name"],progress:["value","max"],meter:["value","min","max","low","high","optimum"],details:["open:v"],summary:e,command:["type","label","icon","disabled:v","checked:v","radiogroup","command"],menu:["type","label"],dialog:["open:v"]},n=["accesskey","class","contenteditable:b","contextmenu","dir:d","draggable:a","dropzone","hidden:v","id","inert:v","itemid","itemprop","itemref","itemscope:v","itemtype","lang","role","spellcheck:b","style","tabindex","title","translate"],o=["onabort","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformchange","onforminput","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onreadystatechange","onseeked","onseeking","onselect","onshow","onstalled","onsubmit","onsuspend","ontimeupdate","onvolumechange","onwaiting"],t={b:["true","false"],a:["true","false","auto"],d:["ltr","rtl"],m:["get","post"],o:["on","off"],t:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"],bt:["button","submit","reset"],xo:["anonymous","use-credentials"]};return{collectTags:function(e){for(var s in r)e(s)},collectAttributes:function(e,s){if(n.forEach(function(e){var r=e.split(":");s(r[0],r[1])}),o.forEach(function(e){s(e,"event")}),e){var t=r[e];t&&t.forEach(function(e){var r=e.split(":");s(r[0],r[1])})}},collectValues:function(e,o,a){var i=o+":",l=function(e){e.forEach(function(e){if(e.length>i.length&&s.startsWith(e,i)){var r=e.substr(i.length);if("v"===r)a(o);else{var n=t[r];n&&n.forEach(a)}}})},c=r[e];c&&l(c),l(n)}}}function o(){var e={input:["ng-model","ng-required","ng-minlength","ng-maxlength","ng-pattern","ng-trim"],select:["ng-model"],textarea:["ng-model","ng-required","ng-minlength","ng-maxlength","ng-pattern","ng-trim"]},r=["ng-app","ng-bind","ng-bindhtml","ng-bindtemplate","ng-blur","ng-change","ng-checked","ng-class","ng-classeven","ng-classodd","ng-click","ng-cloak","ng-controller","ng-copy","ng-csp","ng-cut","ng-dblclick","ng-disabled","ng-focus","ng-form","ng-hide","ng-href","ng-if","ng-include","ng-init","ng-jq","ng-keydown","ng-keypress","ng-keyup","ng-list","ng-modelOptions","ng-mousedown","ng-mouseenter","ng-mouseleave","ng-mousemove","ng-mouseover","ng-mouseup","ng-nonbindable","ng-open","ng-options","ng-paste","ng-pluralize","ng-readonly","ng-repeat","ng-selected","ng-show","ng-src","ng-srcset","ng-style","ng-submit","ng-switch","ng-transclude","ng-value"];return{collectTags:function(){},collectAttributes:function(s,n){if(s){var o=e[s];o&&o.forEach(function(e){n(e,null),n("data-"+e,null)})}r.forEach(function(e){n(e,null),n("data-"+e,null)})},collectValues:function(){}}}r.getHTML5TagProvider=n,r.getAngularTagProvider=o});var __extends=this.__extends||function(e,r){function s(){this.constructor=e}for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]);s.prototype=r.prototype,e.prototype=new s};define("vs/languages/html/htmlWorker",["require","exports","vs/base/lib/winjs.base","vs/editor/worker/modesWorker","vs/languages/lib/htmlLib","./htmlTags","vs/base/network","vs/editor/core/range","vs/base/strings"],function(e,r,s,n,o,t,a,i,l){function c(e,r){var s=r.column-1,n=r.lineNumber,o=e.getLineTokens(n),t=e.getLineContent(n),a=o.findIndexOfOffset(s),i=o.getTokenType(a),c=o.getTokenStartIndex(a),d=o.getTokenEndIndex(a,t.length);return""!==i&&!l.startsWith(i,"delimiter")||c!==s||(a--,a>=0?(i=o.getTokenType(a),c=o.getTokenStartIndex(a),d=o.getTokenEndIndex(a,t.length)):(i="",c=d=0)),{getTokenType:function(){return i},isTagToken:function(){return l.startsWith(i,m)},isAtTokenEnd:function(){return s===d},isAtTokenStart:function(){return s===c},getTokenContent:function(){return t.substring(c,d)},isOpenBrace:function(){return d>c&&"<"===t.charAt(c)},scanBack:function(){if(0>=n)return!1;a--;do{for(;a>=0;){if(i=o.getTokenType(a),c=o.getTokenStartIndex(a),d=o.getTokenEndIndex(a,t.length),l.startsWith(i,"delimiter")||l.startsWith(i,"tag")||l.startsWith(i,"attribute"))return!0;a--}n--,n>0&&(o=e.getLineTokens(n),t=e.getLineContent(n),a=o.getTokenCount()-1)}while(n>0);return o=null,i=t="",c=d=0,!1}}}var d;!function(e){e[e.LOOKING_FOR_HREF_OR_SRC=1]="LOOKING_FOR_HREF_OR_SRC",e[e.AFTER_HREF_OR_SRC=2]="AFTER_HREF_OR_SRC"}(d||(d={}));var m="tag.html.tag-",u=function(e){function r(r,s,n){e.call(this,r,s,n),this._requestService=r.requestService,this._tagProviders=[],this._tagProviders.push(t.getHTML5TagProvider()),this.addCustomTagProviders(this._tagProviders)}return __extends(r,e),r.prototype.addCustomTagProviders=function(e){e.push(t.getAngularTagProvider())},r.prototype.format=function(e,r,n){var t=this.resourceService.get(e),a=r?t.getValueInRange(r):t.getValue(),i=o.style_html(a,{indent_size:n.insertSpaces?n.tabSize:1,indent_char:n.insertSpaces?" ":"	",max_char:120});return s.TPromise.as([{range:r,text:i}])},r.prototype.collectTagSuggestions=function(e){this._tagProviders.forEach(function(r){r.collectTags(function(r){e.push({label:r,codeSnippet:r,type:"property"})})})},r.prototype.collectContentSuggestions=function(){},r.prototype.collectAttributeSuggestions=function(e,r){var s=null;do{if(e.isTagToken()){s=e.getTokenContent();break}if("delimiter.start.html"===e.getTokenType())break}while(e.scanBack());this._tagProviders.forEach(function(e){e.collectAttributes(s,function(e,s){var n=e;"v"!==s&&(n+='="{{}}"'),r.push({label:e,codeSnippet:n,type:"handler"===s?"function":"value"})})})},r.prototype.collectAttributeValueSuggestions=function(e,r){for(var s="delimiter.assign.html"===e.getTokenType(),n=null,o=null;e.scanBack();)if("attribute.name.html"===e.getTokenType()){n=e.getTokenContent();break}for(;e.scanBack();){if(e.isTagToken()){o=e.getTokenContent();break}if("delimiter.start.html"===e.getTokenType())return}this._tagProviders.forEach(function(e){e.collectValues(o,n,function(e){r.push({label:e,codeSnippet:s?'"'+e+'"':e,type:"unit"})})})},r.prototype.doSuggest=function(e,r){var n=this.resourceService.get(e),o=n.getWordUntilPosition(r,!0,!0).word,t=[],a=c(n,r);return a.isTagToken()?this.collectTagSuggestions(t):"delimiter.start.html"!==a.getTokenType()&&"delimiter.end.html"!==a.getTokenType()||!a.isAtTokenEnd()?"attribute.name.html"===a.getTokenType()?this.collectAttributeSuggestions(a,t):"attribute.value.html"===a.getTokenType()||"delimiter.assign.html"===a.getTokenType()&&a.isAtTokenEnd()?this.collectAttributeValueSuggestions(a,t):""===a.getTokenType()&&(a.scanBack()?a.isTagToken()||"attribute.value.html"===a.getTokenType()||"attribute.name.html"===a.getTokenType()?this.collectAttributeSuggestions(a,t):"delimiter.assign.html"===a.getTokenType()?this.collectAttributeValueSuggestions(a,t):("delimiter.start.html"===a.getTokenType()||"delimiter.end.html"===a.getTokenType())&&(a.isOpenBrace()?this.collectTagSuggestions(t):this.collectContentSuggestions(t)):this.collectContentSuggestions(t)):a.isOpenBrace()?this.collectTagSuggestions(t):this.collectContentSuggestions(t),s.Promise.as({currentWord:o,suggestions:t})},r._stripQuotes=function(e){return e.replace(/^'([^']+)'$/,function(e,r){return r}).replace(/^"([^"]+)"$/,function(e,r){return r})},r.prototype._getWorkspaceUrl=function(e,s,n){if(n=r._stripQuotes(n),/^\s*javascript\:/i.test(n)||/^\s*\#/i.test(n))return null;if(/^\s*https?:\/\//i.test(n))return n.replace(/^\s*/g,"");if(/^\s*\/\//i.test(n)){var o=e.getScheme(),t="http";return o===a.schemas.https&&(t=a.schemas.https),t+":"+n.replace(/^\s*/g,"")}var i=e.combine(n).toString();if(s&&e.startsWith(s)){var c=s.toString(),d=l.commonPrefixLength(c,i);return c+i.substr(d)}return i},r.prototype.createLink=function(e,r,s,n,o,t){var a=this._getWorkspaceUrl(e,r,s);return a?{range:{startLineNumber:n,startColumn:o,endLineNumber:n,endColumn:t},url:a}:null},r.prototype._computeHTMLLinks=function(e){var r,s,n,o,t,i,l,c,m,u,h=e.getLineCount(),b=[],p=d.LOOKING_FOR_HREF_OR_SRC,w=e.getAssociatedResource(),v=this._requestService.getRequestUrl("root","",!0),f=v?new a.URL(v):null;for(r=1;h>=r;r++)for(s=e.getLineContent(r),n=s.length,o=e.getLineTokens(r),l=0,i=o.getTokenCount();i>l;l++)switch(t=o.getTokenType(l)){case"delimiter.assign.html":case"":break;case"attribute.name.html":p===d.LOOKING_FOR_HREF_OR_SRC&&(c=o.getTokenEndIndex(l,n),m=s.substring(o.getTokenStartIndex(l),c).toLowerCase(),("src"===m||"href"===m)&&(p=d.AFTER_HREF_OR_SRC));break;case"attribute.value.html":p===d.AFTER_HREF_OR_SRC&&(c=o.getTokenEndIndex(l,n),m=s.substring(o.getTokenStartIndex(l),c),u=this.createLink(w,f,m,r,o.getTokenStartIndex(l)+2,c),u&&b.push(u),p=d.LOOKING_FOR_HREF_OR_SRC);default:0===t.indexOf("tag.html")?p=d.LOOKING_FOR_HREF_OR_SRC:p===d.AFTER_HREF_OR_SRC&&(p=d.LOOKING_FOR_HREF_OR_SRC)}return b},r.prototype.computeLinks=function(r){var s=this;return e.prototype.computeLinks.call(this,r).then(function(e){var n,o,t,a,l,c,d,m=s.resourceService.get(r),u=s._computeHTMLLinks(m),h=[];for(n=0,t=0,o=e.length,a=u.length;o>n&&a>t;)l=e[n],c=u[t],i.areIntersectingOrTouching(l.range,c.range)?n++:(d=i.compareRangesUsingStarts(l.range,c.range),0>d?(h.push(l),n++):(h.push(c),t++));for(;o>n;n++)h.push(e[n]);for(;a>t;t++)h.push(u[t]);return h})},r}(n.AbstractWorkerMode);r.HTMLWorker=u});