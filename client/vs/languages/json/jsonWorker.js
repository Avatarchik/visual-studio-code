/*---------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
"use strict";var __extends=this.__extends||function(e,r){function s(){this.constructor=e}for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]);s.prototype=r.prototype,e.prototype=new s};define("vs/languages/json/parser/jsonParser",["require","exports","vs/nls!vs/languages/json/jsonWorker","vs/base/arrays","vs/base/types","vs/base/json"],function(e,r,s,n,o,t){var a=function(){function e(e,r,s,n,o){this.type=r,this.name=s,this.start=n,this.end=o,this.parent=e}return e.prototype.getPath=function(){var e=[];return this.parent?(e=this.parent.getPath(),this.name&&e.push(this.name),e):e},e.prototype.getChildNodes=function(){return[]},e.prototype.getValue=function(){},e.prototype.contains=function(e,r){return void 0===r&&(r=!1),e>=this.start&&e<this.end||r&&e===this.end},e.prototype.visit=function(e){return e(this)},e.prototype.getNodeFromOffset=function(e){var r=function(s){if(e>=s.start&&e<s.end){for(var n=s.getChildNodes(),o=0;o<n.length&&n[o].start<=e;o++){var t=r(n[o]);if(t)return t}return s}return null};return r(this)},e.prototype.getNodeFromOffsetEndInclusive=function(e){var r=function(s){if(e>=s.start&&e<=s.end){for(var n=s.getChildNodes(),o=0;o<n.length&&n[o].start<=e;o++){var t=r(n[o]);if(t)return t}return s}return null};return r(this)},e.prototype.validate=function(e,r,o,t){var a=this;if(void 0===t&&(t=-1),-1===t||this.contains(t)){if(Array.isArray(e.type)?n.contains(e.type,this.type)===!1?r.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",0,e.type.join())}):e.type.length>0&&(r.typeMatch=!0):e.type&&(this.type!==e.type?r.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",1,e.type)}):r.typeMatch=!0),Array.isArray(e.allOf)&&e.allOf.forEach(function(e){a.validate(e,r,o,t)}),e.not){var i=new b,l=[];this.validate(e.not,i,l,t),i.hasErrors()||r.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",2)}),o&&l.forEach(function(e){e.inverted=!e.inverted,o.push(e)})}var c=function(e,n){var t=0,i=null;return e.forEach(function(e){var r=new b,s=[];if(a.validate(e,r,s),r.hasErrors()||t++,i)if(n||r.hasErrors()||i.validationResult.hasErrors()){var o=r.compare(i.validationResult);o>0?i={schema:e,validationResult:r,matchingSchemas:s}:0===o&&i.matchingSchemas.push.apply(i.matchingSchemas,s)}else i.matchingSchemas.push.apply(i.matchingSchemas,s),i.validationResult.propertiesMatches+=r.propertiesMatches,i.validationResult.propertiesValueMatches+=r.propertiesValueMatches;else i={schema:e,validationResult:r,matchingSchemas:s}}),t>1&&n&&r.warnings.push({location:{start:a.start,end:a.start+1},message:s.localize("vs_languages_json_parser_jsonParser",3)}),null!==i&&(r.merge(i.validationResult),r.propertiesMatches+=i.validationResult.propertiesMatches,r.propertiesValueMatches+=i.validationResult.propertiesValueMatches,o&&o.push.apply(o,i.matchingSchemas)),t};Array.isArray(e.anyOf)&&c(e.anyOf,!1),Array.isArray(e.oneOf)&&c(e.oneOf,!0),Array.isArray(e.enum)&&n.contains(e.enum,this.getValue())===!1&&r.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",4,JSON.stringify(e.enum))}),null!==o&&o.push({node:this,schema:e})}},e}();r.ASTNode=a;var i=function(e){function r(r,s,n,o){e.call(this,r,"null",s,n,o)}return __extends(r,e),r.prototype.getValue=function(){return null},r}(a);r.NullASTNode=i;var l=function(e){function r(r,s,n,o,t){e.call(this,r,"boolean",s,o,t),this.value=n}return __extends(r,e),r.prototype.getValue=function(){return this.value},r}(a);r.BooleanASTNode=l;var c=function(e){function r(r,s,n,o){e.call(this,r,"array",s,n,o),this.items=[]}return __extends(r,e),r.prototype.getChildNodes=function(){return this.items},r.prototype.getValue=function(){return this.items.map(function(e){return e.getValue()})},r.prototype.addItem=function(e){return e?(this.items.push(e),!0):!1},r.prototype.visit=function(e){for(var r=e(this),s=0;s<this.items.length&&r;s++)r=this.items[s].visit(e);return r},r.prototype.validate=function(r,n,o,t){var a=this;if(void 0===t&&(t=-1),-1===t||this.contains(t)){if(e.prototype.validate.call(this,r,n,o,t),Array.isArray(r.items)){var i=r.items;i.forEach(function(e,s){var i=new b,l=a.items[s];l?(l.validate(e,i,o,t),n.mergePropertyMatch(i)):a.items.length>=r.items.length&&n.propertiesValueMatches++}),r.additionalItems===!1&&this.items.length>i.length?n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",5,i.length)}):this.items.length>=r.items.length&&(n.propertiesValueMatches+=this.items.length-r.items.length)}else r.items&&this.items.forEach(function(e){var s=new b;e.validate(r.items,s,o,t),n.mergePropertyMatch(s)});if(r.minItems&&this.items.length<r.minItems&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",6,r.minItems)}),r.maxItems&&this.items.length>r.maxItems&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",7,r.minItems)}),r.uniqueItems===!0){var l=this.items.map(function(e){return e.getValue()}),c=l.some(function(e,r){return r!==l.lastIndexOf(e)});c&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",8)})}}},r}(a);r.ArrayASTNode=c;var d=function(e){function r(r,s,n,o){e.call(this,r,"number",s,n,o),this.isInteger=!0,this.value=Number.NaN}return __extends(r,e),r.prototype.getValue=function(){return this.value},r.prototype.validate=function(r,t,a,i){if(void 0===i&&(i=-1),-1===i||this.contains(i)){var l=!1;("integer"===r.type||Array.isArray(r.type)&&n.contains(r.type,"integer"))&&(l=!0),l&&this.isInteger===!0&&(this.type="integer"),e.prototype.validate.call(this,r,t,a,i),this.type="number";var c=this.getValue();o.isNumber(r.multipleOf)&&c%r.multipleOf!==0&&t.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",9,r.multipleOf)}),o.isUndefined(r.minimum)||(r.exclusiveMinimum&&c<=r.minimum&&t.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",10,r.minimum)}),!r.exclusiveMinimum&&c<r.minimum&&t.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",11,r.minimum)})),o.isUndefined(r.maximum)||(r.exclusiveMaximum&&c>=r.maximum&&t.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",12,r.maximum)}),!r.exclusiveMaximum&&c>r.maximum&&t.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",13,r.maximum)}))}},r}(a);r.NumberASTNode=d;var u=function(e){function r(r,s,n,o,t){this.isKey=n,this.value="",e.call(this,r,"string",s,o,t)}return __extends(r,e),r.prototype.getValue=function(){return this.value},r.prototype.validate=function(r,n,o,t){if(void 0===t&&(t=-1),(-1===t||this.contains(t))&&(e.prototype.validate.call(this,r,n,o,t),r.minLength&&this.value.length<r.minLength&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",14,r.minLength)}),r.maxLength&&this.value.length>r.maxLength&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",15,r.maxLength)}),r.pattern)){var a=new RegExp(r.pattern);a.test(this.value)||n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",16,r.pattern)})}},r}(a);r.StringASTNode=u;var m=function(e){function r(r,s){e.call(this,r,"property",null,s.start),this.key=s,s.parent=this,s.name=s.value,this.colonOffset=-1}return __extends(r,e),r.prototype.getChildNodes=function(){return this.value?[this.key,this.value]:[this.key]},r.prototype.setValue=function(e){return this.value=e,null!==e},r.prototype.visit=function(e){return e(this)&&this.key.visit(e)&&this.value&&this.value.visit(e)},r.prototype.validate=function(e,r,s,n){void 0===n&&(n=-1),(-1===n||this.contains(n))&&this.value&&this.value.validate(e,r,s,n)},r}(a);r.PropertyASTNode=m;var h=function(e){function r(r,s,n,o){e.call(this,r,"object",s,n,o),this.properties=[]}return __extends(r,e),r.prototype.getChildNodes=function(){return this.properties},r.prototype.addProperty=function(e){return e?(this.properties.push(e),!0):!1},r.prototype.getFirstProperty=function(e){for(var r=0;r<this.properties.length;r++)if(this.properties[r].key.value===e)return this.properties[r];return null},r.prototype.getKeyList=function(){return this.properties.map(function(e){return e.key.getValue()})},r.prototype.getValue=function(){var e={};return this.properties.forEach(function(r){var s=r.value&&r.value.getValue();s&&(e[r.key.getValue()]=s)}),e},r.prototype.visit=function(e){for(var r=e(this),s=0;s<this.properties.length&&r;s++)r=this.properties[s].visit(e);return r},r.prototype.validate=function(r,n,t,a){var i=this;if(void 0===a&&(a=-1),-1===a||this.contains(a)){e.prototype.validate.call(this,r,n,t,a);var l={},c=[];this.properties.forEach(function(e){var r=e.key.value;l[r]=e.value,c.push(r)}),Array.isArray(r.required)&&r.required.forEach(function(e){l[e]||n.warnings.push({location:{start:i.start,end:i.start+1},message:s.localize("vs_languages_json_parser_jsonParser",17,e)})});var d=function(e){for(var r=c.indexOf(e);r>=0;)c.splice(r,1),r=c.indexOf(e)};r.properties&&Object.keys(r.properties).forEach(function(e){d(e);var s=r.properties[e],o=l[e];if(o){var i=new b;o.validate(s,i,t,a),n.mergePropertyMatch(i)}}),r.patternProperties&&Object.keys(r.patternProperties).forEach(function(e){var s=new RegExp(e);c.slice(0).forEach(function(o){if(s.test(o)){d(o);var i=l[o];if(i){var c=new b;i.validate(r.patternProperties[e],c,t,a),n.mergePropertyMatch(c)}}})}),o.isObject(r.additionalProperties)?c.forEach(function(e){var s=l[e];if(s){var o=new b;s.validate(r.additionalProperties,o,t,a),n.mergePropertyMatch(o)}}):r.additionalProperties===!1&&c.length>0&&c.forEach(function(e){var r=l[e];if(r){var o=r.parent;n.warnings.push({location:{start:o.key.start,end:o.key.end},message:s.localize("vs_languages_json_parser_jsonParser",18,e)})}}),r.maxProperties&&this.properties.length>r.maxProperties&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",19,r.maxProperties)}),r.minProperties&&this.properties.length<r.minProperties&&n.warnings.push({location:{start:this.start,end:this.end},message:s.localize("vs_languages_json_parser_jsonParser",20,r.minProperties)}),o.isObject(r.dependencies)&&Object.keys(r.dependencies).forEach(function(e){var c=l[e];if(c)if(Array.isArray(r.dependencies[e])){var d=r.dependencies[e];d.forEach(function(r){l[r]?n.propertiesValueMatches++:n.warnings.push({location:{start:i.start,end:i.end},message:s.localize("vs_languages_json_parser_jsonParser",21,r,e)})})}else if(o.isObject(r.dependencies[e])){var u=r.dependencies[e],m=new b;i.validate(u,m,t,a),n.mergePropertyMatch(m)}})}},r}(a);r.ObjectASTNode=h;var p=function(){function e(){this.ignoreDanglingComma=!1}return e}();r.JSONDocumentConfig=p;var b=function(){function e(){this.errors=[],this.warnings=[],this.propertiesMatches=0,this.propertiesValueMatches=0,this.typeMatch=!1}return e.prototype.hasErrors=function(){return!!this.errors.length||!!this.warnings.length},e.prototype.mergeAll=function(e){var r=this;e.forEach(function(e){r.merge(e)})},e.prototype.merge=function(e){this.errors=this.errors.concat(e.errors),this.warnings=this.warnings.concat(e.warnings)},e.prototype.mergePropertyMatch=function(e){this.merge(e),this.propertiesMatches++,e.hasErrors()||this.propertiesValueMatches++},e.prototype.compare=function(e){var r=this.hasErrors();return r!==e.hasErrors()?r?-1:1:this.typeMatch!==e.typeMatch?e.typeMatch?-1:1:this.propertiesValueMatches!==e.propertiesValueMatches?this.propertiesValueMatches-e.propertiesValueMatches:this.propertiesMatches-e.propertiesMatches},e}();r.ValidationResult=b;var v=function(){function e(e){this.config=e,this.validationResult=new b}return Object.defineProperty(e.prototype,"errors",{get:function(){return this.validationResult.errors},set:function(e){this.validationResult.errors=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"warnings",{get:function(){return this.validationResult.warnings},set:function(e){this.validationResult.warnings=e},enumerable:!0,configurable:!0}),e.prototype.getNodeFromOffset=function(e){return this.root&&this.root.getNodeFromOffset(e)},e.prototype.getNodeFromOffsetEndInclusive=function(e){return this.root&&this.root.getNodeFromOffsetEndInclusive(e)},e.prototype.visit=function(e){this.root&&this.root.visit(e)},e.prototype.validate=function(e,r,s){void 0===r&&(r=null),void 0===s&&(s=-1),this.root&&this.root.validate(e,this.validationResult,r,s)},e}();r.JSONDocument=v;var w=function(){function e(){}return e.prototype.parse=function(e,r){function n(e){return _.getToken()===e?(_.scan(),!0):!1}function o(e,r,s,n){if(void 0===r&&(r=null),void 0===s&&(s=[]),void 0===n&&(n=[]),0===S.errors.length||S.errors[0].location.start!==_.getTokenOffset()){var o={message:e,location:{start:_.getTokenOffset(),end:_.getTokenOffset()+_.getTokenLength()}};S.errors.push(o)}if(r&&b(r,!1),s.length+n.length>0)for(var a=_.getToken();a!==t.SyntaxKind.EOF;){if(-1!==s.indexOf(a)){_.scan();break}if(-1!==n.indexOf(a))break;a=_.scan()}return r}function a(){switch(_.getTokenError()){case t.ScanError.InvalidUnicode:return o(s.localize("vs_languages_json_parser_jsonParser",22)),!0;case t.ScanError.InvalidEscapeCharacter:return o(s.localize("vs_languages_json_parser_jsonParser",23)),!0;case t.ScanError.UnexpectedEndOfNumber:return o(s.localize("vs_languages_json_parser_jsonParser",24)),!0;case t.ScanError.UnexpectedEndOfComment:return o(s.localize("vs_languages_json_parser_jsonParser",25)),!0;case t.ScanError.UnexpectedEndOfString:return o(s.localize("vs_languages_json_parser_jsonParser",26)),!0}return!1}function b(e,r){return e.end=_.getTokenOffset()+_.getTokenLength(),r&&_.scan(),e}function w(e,r){if(_.getToken()!==t.SyntaxKind.OpenBracketToken)return null;var a=new c(e,r,_.getTokenOffset());_.scan();var i=0;if(a.addItem(T(a,""+i++)))for(;n(t.SyntaxKind.CommaToken);)a.addItem(T(a,""+i++))||S.config.ignoreDanglingComma||o(s.localize("vs_languages_json_parser_jsonParser",27));return _.getToken()!==t.SyntaxKind.CloseBracketToken?o(s.localize("vs_languages_json_parser_jsonParser",28),a):b(a,!0)}function f(e,r){var n=y(null,null,!0);if(!n){if(_.getToken()===t.SyntaxKind.Unknown){var a=_.getTokenValue();a.length>0&&("'"===a.charAt(0)||t.isLetter(a.charAt(0).charCodeAt(0)))&&o(s.localize("vs_languages_json_parser_jsonParser",29))}return null}var i=new m(e,n);return r[n.value]&&S.warnings.push({location:{start:i.key.start,end:i.key.end},message:s.localize("vs_languages_json_parser_jsonParser",30)}),r[n.value]=!0,_.getToken()!==t.SyntaxKind.ColonToken?o(s.localize("vs_languages_json_parser_jsonParser",31),i,[],[t.SyntaxKind.CloseBraceToken,t.SyntaxKind.CommaToken]):(i.colonOffset=_.getTokenOffset(),_.scan(),i.setValue(T(i,i.key.getValue()))?b(i,!1):o(s.localize("vs_languages_json_parser_jsonParser",32),i,[],[t.SyntaxKind.CloseBraceToken,t.SyntaxKind.CommaToken]))}function g(e,r){if(_.getToken()!==t.SyntaxKind.OpenBraceToken)return null;var a=new h(e,r,_.getTokenOffset());_.scan();var i={};if(a.addProperty(f(a,i)))for(;n(t.SyntaxKind.CommaToken);)a.addProperty(f(a,i))||S.config.ignoreDanglingComma||o(s.localize("vs_languages_json_parser_jsonParser",33));return _.getToken()!==t.SyntaxKind.CloseBraceToken?o(s.localize("vs_languages_json_parser_jsonParser",34),a):b(a,!0)}function y(e,r,s){if(_.getToken()!==t.SyntaxKind.StringLiteral)return null;var n=new u(e,r,s,_.getTokenOffset());return n.value=_.getTokenValue(),a(),b(n,!0)}function k(e,r){if(_.getToken()!==t.SyntaxKind.NumericLiteral)return null;var n=new d(e,r,_.getTokenOffset());if(!a()){var i=_.getTokenValue();try{var l=JSON.parse(i);if("number"!=typeof l)return o(s.localize("vs_languages_json_parser_jsonParser",35),n);n.value=l}catch(c){return o(s.localize("vs_languages_json_parser_jsonParser",36),n)}n.isInteger=-1===i.indexOf(".")}return b(n,!0)}function x(e,r){var s;switch(_.getToken()){case t.SyntaxKind.NullKeyword:s=new i(e,r,_.getTokenOffset());break;case t.SyntaxKind.TrueKeyword:s=new l(e,r,!0,_.getTokenOffset());break;case t.SyntaxKind.FalseKeyword:s=new l(e,r,!1,_.getTokenOffset());break;default:return null}return b(s,!0)}function T(e,r){return w(e,r)||g(e,r)||y(e,r,!1)||k(e,r)||x(e,r)}void 0===r&&(r=new p);var S=new v(r),_=t.createScanner(e,!0);return _.scan(),S.root=T(null,"root"),S.root?_.getToken()!==t.SyntaxKind.EOF&&o(s.localize("vs_languages_json_parser_jsonParser",38)):o(s.localize("vs_languages_json_parser_jsonParser",37)),S},e}();r.JSONParser=w}),define("vs/languages/json/jsonSchemaService",["require","exports","vs/nls!vs/languages/json/jsonWorker","vs/base/objects","vs/base/strings","vs/base/types","vs/base/lib/winjs.base","vs/platform/services"],function(e,r,s,n,o,t,a,i){function l(e,r){for(var s=function(e,r){if(!r)return e;var s=e;return r.substr(1).split("/").some(function(e){return s=s[e],!s}),s||{}},o=function(n){var o=n.split("#",2);if(o[0].length>0)return r?r(o[0]).then(function(e){return s(e,o[1])}):a.TPromise.as({});var t=s(e,o[1]);return a.TPromise.as(t)},i=[{parent:null,key:null,value:e}],l=[];i.length;){var c=i.pop();if(Array.isArray(c.value))c.value.forEach(function(e,r){i.push({parent:c.value,key:r,value:e})});else if(t.isObject(c.value))if(c.value.$ref){var d=o(c.value.$ref).then(function(e){n.mixin(c.value,e,!1),delete c.value.$ref});l.push(d)}else Object.keys(c.value).forEach(function(e){i.push({parent:c.value,key:e,value:c.value[e]})})}return a.TPromise.join(l).then(function(){return new u(e)})}var c=function(){function e(e,r){this.url=e,this.filePatterns=r}return e.prototype.matchesPattern=function(e){for(var r=0;r<this.filePatterns.length;r++)if(this.filePatterns[r].test(e))return!0;return!1},e}(),d=function(){function e(e,r,s){void 0===s&&(s=null),this.service=e,this.url=r,this.schema=null,s&&(this.schema=l(s))}return e.prototype.getSchema=function(){return null===this.schema&&(this.schema=this.service.fetchFileSchema(this.url)),this.schema},e.prototype.clearSchema=function(){this.schema=null},e}(),u=function(){function e(e,r){void 0===r&&(r=null),this.schema=e,this.loadError=r}return e.prototype.getSection=function(e){return this.getSectionRecursive(e,this.schema)},e.prototype.getSectionRecursive=function(e,r){var s=this;if(!r||0===e.length)return r;var n=e.shift();if(r.properties&&r.properties[n])return this.getSectionRecursive(e,r.properties[n]);if(t.isObject(r.patternProperties))Object.keys(r.patternProperties).forEach(function(o){var t=new RegExp(o);return t.test(n)?s.getSectionRecursive(e,r.patternProperties[o]):void 0});else{if(t.isObject(r.additionalProperties))return this.getSectionRecursive(e,r.additionalProperties);if(n.match("[0-9]+")){if(t.isObject(r.items))return this.getSectionRecursive(e,r.items);if(Array.isArray(r.items))try{var o=parseInt(n,10);return r.items[o]?this.getSectionRecursive(e,r.items[o]):null}catch(a){return null}}}return null},e}();r.FileSchema=u;var m=function(){function e(e){var r=this;this.requestService=e.requestService,this.callOnDispose=[];var s=e.resourceService;s&&this.callOnDispose.push(s.addBulkListener(function(e){return r.onResourceChange(e)})),this.configurationSchemas={},this.preloadedSchemas={},this.schemasById={},this.schemasFilePatternMapping=[],this.addPreloadedFileSchemas()}return e.prototype.dispose=function(){for(;this.callOnDispose.length>0;)this.callOnDispose.pop()()},e.prototype.onResourceChange=function(e){for(var r=0,s=e.length;s>r;r++){var n=e[r];if(n.getType()===i.ResourceEvents.CHANGED){var o=n.getData(),t=o.url.toString(),a=this.schemasById[t];a&&a.clearSchema()}}},e.prototype.setConfigurationSchemas=function(e){var r=this,s={};e.forEach(function(e){s[e.id]=e});var n=function(e){return a.Promise.as(s[e])};e.forEach(function(e){r.configurationSchemas[e.id]=l(e,n)})},e.prototype.registerExternalSchema=function(e,r,s){void 0===r&&(r=null),void 0===s&&(s=null);var n=new d(this,e,s);return this.schemasById[e]=n,r&&r.length>0&&this.schemasFilePatternMapping.push(new c(e,r)),n},e.prototype.clearExternalSchemas=function(){this.schemasById={},this.schemasFilePatternMapping=[]},e.prototype.getConfigurationSchema=function(e){return this.configurationSchemas[e]},e.prototype.fetchFileSchema=function(e){var r=this.preloadedSchemas[e];return r?r:this.requestService.makeRequest({url:e}).then(function(e){return e.responseText}).then(function(e){var r=null;try{r=JSON.parse(e)}catch(s){}return r?l(r):null},function(r){var n=s.localize("vs_languages_json_jsonSchemaService",0,e,r.statusText||r.toString());return console.log(n),new u({},n)})},e.prototype.getSchemaForResource=function(e,r){if(o.endsWith(e.toLowerCase(),"/user/settings.json"))return this.configurationSchemas["local://configuration/user/settings"];if("inmemory:/.settings/defaults.json"===e)return this.configurationSchemas["local://configuration/default/settings"];if("inmemory:/.keybindings/defaults.json"===e||o.endsWith(e.toLowerCase(),"/user/keybindings.json"))return this.configurationSchemas["local://configuration/user/keybindings"];var s="/.settings/",n=".json",t=e.indexOf(s);if(-1!==t&&o.endsWith(e,n)){var i=e.substring(t+s.length,e.length-n.length);return this.configurationSchemas["local://configuration/workspace/"+i]}if(r&&r.root&&"object"===r.root.type){var l=r.root.properties.filter(function(e){return"$schema"===e.key.value&&!!e.value});if(l.length>0){var c=l[0].value.getValue(),d=this.schemasById[c];if(d)return d.getSchema();if(c)return this.registerExternalSchema(c).getSchema()}}for(var u=this.schemasFilePatternMapping.length-1;u>=0;u--){var m=this.schemasFilePatternMapping[u];if(m.matchesPattern(e)){var h=this.schemasById[m.url];if(h)return h.getSchema()}}return a.TPromise.as(null)},e.prototype.addPreloadedFileSchema=function(e,r){this.preloadedSchemas[e]=l(r)},e.prototype.addPreloadedFileSchemas=function(){this.addPreloadedFileSchema("http://json-schema.org/draft-04/schema#",{id:"http://json-schema.org/draft-04/schema#",title:s.localize("vs_languages_json_jsonSchemaService",1),$schema:"http://json-schema.org/draft-04/schema#",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{default:0}]},simpleTypes:{type:"string",enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri",description:s.localize("vs_languages_json_jsonSchemaService",2)},$schema:{type:"string",format:"uri",description:s.localize("vs_languages_json_jsonSchemaService",3)},title:{type:"string",description:s.localize("vs_languages_json_jsonSchemaService",4)},description:{type:"string",description:s.localize("vs_languages_json_jsonSchemaService",5)},default:{description:s.localize("vs_languages_json_jsonSchemaService",6)},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0,description:s.localize("vs_languages_json_jsonSchemaService",7)},maximum:{type:"number",description:s.localize("vs_languages_json_jsonSchemaService",8)},exclusiveMaximum:{type:"boolean",default:!1,description:s.localize("vs_languages_json_jsonSchemaService",9)},minimum:{type:"number",description:s.localize("vs_languages_json_jsonSchemaService",10)},exclusiveMinimum:{type:"boolean",default:!1,description:s.localize("vs_languages_json_jsonSchemaService",11)},maxLength:{allOf:[{$ref:"#/definitions/positiveInteger"}],description:s.localize("vs_languages_json_jsonSchemaService",12)},minLength:{allOf:[{$ref:"#/definitions/positiveIntegerDefault0"}],description:s.localize("vs_languages_json_jsonSchemaService",13)},pattern:{type:"string",format:"regex",description:s.localize("vs_languages_json_jsonSchemaService",14)},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{},description:s.localize("vs_languages_json_jsonSchemaService",15)},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{},description:s.localize("vs_languages_json_jsonSchemaService",16)},maxItems:{allOf:[{$ref:"#/definitions/positiveInteger"}],description:s.localize("vs_languages_json_jsonSchemaService",17)},minItems:{allOf:[{$ref:"#/definitions/positiveIntegerDefault0"}],description:s.localize("vs_languages_json_jsonSchemaService",18)},uniqueItems:{type:"boolean",default:!1,description:s.localize("vs_languages_json_jsonSchemaService",19)},maxProperties:{allOf:[{$ref:"#/definitions/positiveInteger"}],description:s.localize("vs_languages_json_jsonSchemaService",20)},minProperties:{allOf:[{$ref:"#/definitions/positiveIntegerDefault0"}],description:s.localize("vs_languages_json_jsonSchemaService",21)},required:{allOf:[{$ref:"#/definitions/stringArray"}],description:s.localize("vs_languages_json_jsonSchemaService",22)},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],default:{},description:s.localize("vs_languages_json_jsonSchemaService",23)},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{},description:s.localize("vs_languages_json_jsonSchemaService",24)},properties:{type:"object",additionalProperties:{$ref:"#"},default:{},description:s.localize("vs_languages_json_jsonSchemaService",25)},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{},description:s.localize("vs_languages_json_jsonSchemaService",26)},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]},description:s.localize("vs_languages_json_jsonSchemaService",27)},enum:{type:"array",minItems:1,uniqueItems:!0,description:s.localize("vs_languages_json_jsonSchemaService",28)},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}],description:s.localize("vs_languages_json_jsonSchemaService",29)},allOf:{allOf:[{$ref:"#/definitions/schemaArray"}],description:s.localize("vs_languages_json_jsonSchemaService",30)},anyOf:{allOf:[{$ref:"#/definitions/schemaArray"}],description:s.localize("vs_languages_json_jsonSchemaService",31)},oneOf:{allOf:[{$ref:"#/definitions/schemaArray"}],description:s.localize("vs_languages_json_jsonSchemaService",32)},not:{allOf:[{$ref:"#"}],description:s.localize("vs_languages_json_jsonSchemaService",33)}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},default:{}}),this.addPreloadedFileSchema("http://json.schemastore.org/project",{title:s.localize("vs_languages_json_jsonSchemaService",34),$schema:"http://json-schema.org/draft-04/schema#",id:"http://json.schemastore.org/project",type:"object",definitions:{compilationOptions:{description:s.localize("vs_languages_json_jsonSchemaService",35),type:"object",properties:{define:{type:"array",items:{type:"string",uniqueItems:!0}},warningsAsErrors:{type:"boolean",default:!1},allowUnsafe:{type:"boolean",default:!1},optimize:{type:"boolean",default:!1},languageVersion:{type:"string",enum:["csharp1","csharp2","csharp3","csharp4","csharp5","csharp6","experimental"]}}},configType:{type:"object",properties:{dependencies:{$ref:"#/definitions/dependencies"},compilationOptions:{$ref:"#/definitions/compilationOptions"},frameworkAssemblies:{$ref:"#/definitions/dependencies"}}},dependencies:{type:"object",additionalProperties:{type:["string","object"],properties:{version:{type:"string",description:s.localize("vs_languages_json_jsonSchemaService",36)},type:{type:"string",default:"default",enum:["default","build"],description:s.localize("vs_languages_json_jsonSchemaService",37)}},id:"nugget-package"},description:s.localize("vs_languages_json_jsonSchemaService",38),id:"nugget-packages"},script:{type:["string","array"],items:{type:"string"},description:s.localize("vs_languages_json_jsonSchemaService",39)}},properties:{authors:{description:s.localize("vs_languages_json_jsonSchemaService",40),type:"array",items:{type:"string",uniqueItems:!0}},bundleExclude:{description:s.localize("vs_languages_json_jsonSchemaService",41),type:["string","array"],items:{type:"string"},default:""},code:{description:s.localize("vs_languages_json_jsonSchemaService",42),type:["string","array"],items:{type:"string"},default:"**\\*.cs"},commands:{description:s.localize("vs_languages_json_jsonSchemaService",43),type:"object",additionalProperties:{type:"string"}},compilationOptions:{$ref:"#/definitions/compilationOptions"},configurations:{type:"object",description:s.localize("vs_languages_json_jsonSchemaService",44),additionalProperties:{type:"object",properties:{compilationOptions:{$ref:"#/definitions/compilationOptions"}}}},dependencies:{$ref:"#/definitions/dependencies"},description:{description:s.localize("vs_languages_json_jsonSchemaService",45),type:"string"},exclude:{description:s.localize("vs_languages_json_jsonSchemaService",46),type:["string","array"],items:{type:"string"},default:["bin/**/*.*","obj/**/*.*"]},frameworks:{description:s.localize("vs_languages_json_jsonSchemaService",47),type:"object",additionalProperties:{$ref:"#/definitions/configType"}},preprocess:{description:s.localize("vs_languages_json_jsonSchemaService",48),type:"string",default:"Compiler\\Preprocess\\**\\*.cs"},resources:{description:s.localize("vs_languages_json_jsonSchemaService",49),type:["string","array"],items:{type:"string"},default:"Compiler\\Resources\\**\\*.cs"},scripts:{type:"object",description:s.localize("vs_languages_json_jsonSchemaService",50),properties:{prepack:{$ref:"#/definitions/script"},postpack:{$ref:"#/definitions/script"},prebundle:{$ref:"#/definitions/script"},postbundle:{$ref:"#/definitions/script"},prerestore:{$ref:"#/definitions/script"},postrestore:{$ref:"#/definitions/script"},prepare:{$ref:"#/definitions/script"}}},shared:{description:s.localize("vs_languages_json_jsonSchemaService",51),type:["string","array"],items:{type:"string"},default:"Compiler\\Shared\\**\\*.cs"},version:{description:s.localize("vs_languages_json_jsonSchemaService",52),type:"string"},webroot:{description:s.localize("vs_languages_json_jsonSchemaService",53),type:"string"}}}),this.addPreloadedFileSchema("http://json.schemastore.org/bower",{title:s.localize("vs_languages_json_jsonSchemaService",54),$schema:"http://json-schema.org/draft-04/schema#",id:"http://json.schemastore.org/bower",type:"object",required:["name"],patternProperties:{"^_":{description:s.localize("vs_languages_json_jsonSchemaService",55),additionalProperties:!0,additionalItems:!0}},properties:{name:{description:s.localize("vs_languages_json_jsonSchemaService",56),type:"string",maxLength:50},description:{description:s.localize("vs_languages_json_jsonSchemaService",57),type:"string"},version:{description:s.localize("vs_languages_json_jsonSchemaService",58),type:"string"},main:{description:s.localize("vs_languages_json_jsonSchemaService",59),type:["string","array"]},license:{description:s.localize("vs_languages_json_jsonSchemaService",60),type:["string","array"],maxLength:140},ignore:{description:s.localize("vs_languages_json_jsonSchemaService",61),type:["string","array"]},keywords:{description:s.localize("vs_languages_json_jsonSchemaService",62),type:"array",items:{type:"string",maxLength:50}},authors:{description:s.localize("vs_languages_json_jsonSchemaService",63),type:"array",items:{type:["string","object"]}},homepage:{description:s.localize("vs_languages_json_jsonSchemaService",64),type:"string"},repository:{description:s.localize("vs_languages_json_jsonSchemaService",65),type:"object",properties:{type:{type:"string",enum:["git"]},url:{type:"string"}}},dependencies:{id:"bower-packages",description:s.localize("vs_languages_json_jsonSchemaService",66),type:"object",additionalProperties:{id:"bower-package",type:"string"}},devDependencies:{id:"bower-packages",description:s.localize("vs_languages_json_jsonSchemaService",67),type:"object",additionalProperties:{id:"bower-package",type:"string"}},resolutions:{description:s.localize("vs_languages_json_jsonSchemaService",68),type:"object"},private:{description:s.localize("vs_languages_json_jsonSchemaService",69),type:"boolean"},exportsOverride:{description:s.localize("vs_languages_json_jsonSchemaService",70),type:"object",additionalProperties:{type:"object",additionalProperties:{type:"string"}}},moduleType:{description:s.localize("vs_languages_json_jsonSchemaService",71),type:"array",items:{enum:["amd","es6","globals","node","yui"]}}}}),this.addPreloadedFileSchema("http://json.schemastore.org/package",{id:"http://json.schemastore.org/package",description:s.localize("vs_languages_json_jsonSchemaService",72),type:"object",required:["name","version"],definitions:{person:{description:s.localize("vs_languages_json_jsonSchemaService",73),type:["object","string"],required:["name"],properties:{name:{type:"string"},url:{type:"string",format:"uri"},email:{type:"string",format:"email"}}},dependency:{id:"npm-packages",description:s.localize("vs_languages_json_jsonSchemaService",74),type:"object",additionalProperties:{type:"string"}}},patternProperties:{"^_":{description:s.localize("vs_languages_json_jsonSchemaService",75),additionalProperties:!0,additionalItems:!0}},properties:{name:{description:s.localize("vs_languages_json_jsonSchemaService",76),type:"string"},version:{description:s.localize("vs_languages_json_jsonSchemaService",77),type:"string"},description:{description:s.localize("vs_languages_json_jsonSchemaService",78),type:"string"},keywords:{description:s.localize("vs_languages_json_jsonSchemaService",79),type:"array"},homepage:{description:s.localize("vs_languages_json_jsonSchemaService",80),type:"string"},bugs:{description:s.localize("vs_languages_json_jsonSchemaService",81),type:["object","string"],properties:{url:{type:"string",description:s.localize("vs_languages_json_jsonSchemaService",82),format:"uri"},email:{type:"string",description:s.localize("vs_languages_json_jsonSchemaService",83)}}},license:{type:"string",description:s.localize("vs_languages_json_jsonSchemaService",84)},licenses:{description:s.localize("vs_languages_json_jsonSchemaService",85),type:"array",items:{type:"object",properties:{type:{type:"string"},url:{type:"string",format:"uri"}}}},author:{$ref:"#/definitions/person"},contributors:{description:s.localize("vs_languages_json_jsonSchemaService",86),type:"array",items:{$ref:"#/definitions/person"}},maintainers:{description:s.localize("vs_languages_json_jsonSchemaService",87),type:"array",items:{$ref:"#/definitions/person"}},files:{description:s.localize("vs_languages_json_jsonSchemaService",88),type:"array",items:{type:"string"}},main:{description:s.localize("vs_languages_json_jsonSchemaService",89),type:"string"},bin:{type:["string","object"],additionalProperties:{type:"string"}},man:{type:["array","string"],description:s.localize("vs_languages_json_jsonSchemaService",90),items:{type:"string"}},directories:{type:"object",properties:{bin:{description:s.localize("vs_languages_json_jsonSchemaService",91),type:"string"},doc:{description:s.localize("vs_languages_json_jsonSchemaService",92),type:"string"},example:{description:s.localize("vs_languages_json_jsonSchemaService",93),type:"string"},lib:{description:s.localize("vs_languages_json_jsonSchemaService",94),type:"string"},man:{description:s.localize("vs_languages_json_jsonSchemaService",95),type:"string"},test:{type:"string"}}},repository:{description:s.localize("vs_languages_json_jsonSchemaService",96),type:"object",properties:{type:{type:"string"},url:{type:"string"}}},scripts:{description:s.localize("vs_languages_json_jsonSchemaService",97),type:"object",additionalProperties:{type:"string"}},config:{description:s.localize("vs_languages_json_jsonSchemaService",98),type:"object",additionalProperties:!0},dependencies:{$ref:"#/definitions/dependency"},devDependencies:{$ref:"#/definitions/dependency"},bundleDependencies:{type:"array",description:s.localize("vs_languages_json_jsonSchemaService",99),items:{type:"string"}},bundledDependencies:{type:"array",description:s.localize("vs_languages_json_jsonSchemaService",100),items:{type:"string"}},optionalDependencies:{$ref:"#/definitions/dependency"},peerDependencies:{$ref:"#/definitions/dependency"},engines:{type:"object",additionalProperties:{type:"string"}},engineStrict:{type:"boolean"},os:{type:"array",items:{type:"string"}},cpu:{type:"array",items:{type:"string"}},preferGlobal:{type:"boolean",description:s.localize("vs_languages_json_jsonSchemaService",101)},private:{type:"boolean",description:s.localize("vs_languages_json_jsonSchemaService",102)},publishConfig:{type:"object",additionalProperties:!0},dist:{type:"object",properties:{shasum:{type:"string"},tarball:{type:"string"}}},readme:{type:"string"}}}),this.addPreloadedFileSchema("http://json.schemastore.org/global",{title:s.localize("vs_languages_json_jsonSchemaService",103),type:"object",additionalProperties:!0,required:["projects"],properties:{projects:{type:"array",description:s.localize("vs_languages_json_jsonSchemaService",104),items:{type:"string"}},sources:{type:"array",description:s.localize("vs_languages_json_jsonSchemaService",105),items:{type:"string"}}}}),this.addPreloadedFileSchema("http://json.schemastore.org/tsconfig",{title:s.localize("vs_languages_json_jsonSchemaService",106),$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{compilerOptions:{type:"object",description:s.localize("vs_languages_json_jsonSchemaService",107),properties:{charset:{type:"string"},codepage:{type:"number"},declaration:{description:s.localize("vs_languages_json_jsonSchemaService",108),type:"boolean"},diagnostics:{type:"boolean"},emitBOM:{type:"boolean"},help:{description:s.localize("vs_languages_json_jsonSchemaService",109),type:"boolean"},listFiles:{type:"boolean"},locale:{type:"string"},mapRoot:{description:s.localize("vs_languages_json_jsonSchemaService",110),type:"string",format:"uri"},module:{description:s.localize("vs_languages_json_jsonSchemaService",111),enum:["commonjs","amd"]},noEmit:{description:s.localize("vs_languages_json_jsonSchemaService",112),type:"boolean"},noEmitOnError:{description:s.localize("vs_languages_json_jsonSchemaService",113),type:"boolean"},noImplicitAny:{description:s.localize("vs_languages_json_jsonSchemaService",114),type:"boolean"},noLib:{type:"boolean"},noLibCheck:{type:"boolean"},noResolve:{type:"boolean"},out:{description:s.localize("vs_languages_json_jsonSchemaService",115),type:"string",format:"uri"},outDir:{description:s.localize("vs_languages_json_jsonSchemaService",116),type:"string",format:"uri"},preserveConstEnums:{description:s.localize("vs_languages_json_jsonSchemaService",117),type:"boolean"},project:{description:s.localize("vs_languages_json_jsonSchemaService",118),type:"string",format:"uri"},removeComments:{description:s.localize("vs_languages_json_jsonSchemaService",119),type:"boolean"},sourceMap:{description:s.localize("vs_languages_json_jsonSchemaService",120),type:"boolean"},sourceRoot:{description:s.localize("vs_languages_json_jsonSchemaService",121),type:"string",format:"uri"},suppressImplicitAnyIndexErrors:{description:s.localize("vs_languages_json_jsonSchemaService",122),type:"boolean"},target:{description:s.localize("vs_languages_json_jsonSchemaService",123),enum:["ES3","ES5","ES6","es3","es5","es6"],default:"ES3"},version:{description:s.localize("vs_languages_json_jsonSchemaService",124),type:"boolean"},watch:{description:s.localize("vs_languages_json_jsonSchemaService",125),type:"boolean"}}},files:{type:"array",description:s.localize("vs_languages_json_jsonSchemaService",126),items:{type:"string",format:"uri"}}}}),this.addPreloadedFileSchema("http://opentools.azurewebsites.net/ticino.plugin.json",{default:{pluginId:"{{}}",contributes:{language:[{id:"",extensions:[]}]}},properties:{pluginId:{description:s.localize("vs_languages_json_jsonSchemaService",127),type:"string"},activationEvents:{description:s.localize("vs_languages_json_jsonSchemaService",128),type:"array",items:{type:"string"}},dependencies:{description:s.localize("vs_languages_json_jsonSchemaService",129),type:"array",items:{type:"string"}},mainModule:{description:s.localize("vs_languages_json_jsonSchemaService",130),type:"string"},contributes:{description:s.localize("vs_languages_json_jsonSchemaService",131),type:"object",default:{language:[{id:"",extensions:[]}]},properties:{language:{description:s.localize("vs_languages_json_jsonSchemaService",132),type:"array",default:[{id:"",extensions:[]}],items:{type:"object",default:{id:"",extensions:[]},properties:{id:{description:s.localize("vs_languages_json_jsonSchemaService",133),type:"string"},extensions:{description:s.localize("vs_languages_json_jsonSchemaService",134),type:"array",items:{type:"string"}},filenames:{description:s.localize("vs_languages_json_jsonSchemaService",135),default:[".foo"],type:"array",items:{type:"string"}},aliases:{description:s.localize("vs_languages_json_jsonSchemaService",136),type:"array",items:{type:"string"}}}}}}},scripts:{description:s.localize("vs_languages_json_jsonSchemaService",137),type:"object",properties:{compile:{description:s.localize("vs_languages_json_jsonSchemaService",138),type:"string"}}}}})
},e}();r.JSONSchemaService=m}),define("vs/languages/json/jsonIntellisense",["require","exports","./parser/jsonParser","vs/base/types","vs/base/lib/winjs.base","vs/nls!vs/languages/json/jsonWorker"],function(e,r,s,n,o,t){var a=function(){function e(e,r){this.schemaService=e.schemaService,this.requestService=e.requestService,this.contributions=r}return e.prototype.doSuggest=function(e,r,n){var t=this,a=r.getWordUntilPosition(n,!0,!0).word,i=new s.JSONParser,l=new s.JSONDocumentConfig;l.ignoreDanglingComma=!0;var c=i.parse(r.getValue(),l),d={currentWord:a,incomplete:!1,suggestions:[]},u={},m={add:function(e){u[e.label]||(u[e.label]=!0,d.suggestions.push(e))},setAsIncomplete:function(){d.incomplete=!0}};return this.schemaService.getSchemaForResource(e.toString(),c).then(function(e){var s=[],a=r.getOffsetFromPosition(n),i=c.getNodeFromOffsetEndInclusive(a),l=!0,u="";if(i){var h=r.getRangeFromOffsetAndLength(i.start,i.end-i.start);if("string"===i.type){var p=i;p.isKey&&(d.overwriteBefore=n.column-h.startColumn,d.overwriteAfter=h.endColumn-n.column,l=!(i.parent&&i.parent.value),u=r.getValueInRange({startColumn:h.startColumn+1,startLineNumber:h.startLineNumber,endColumn:n.column,endLineNumber:n.lineNumber}),i.parent&&(i=i.parent.parent))}}if(i&&"object"===i.type){if(i.start===a)return d;if(e){var b=i.properties,v=0===b.length||a>=b[b.length-1].end;s.push(t.getPropertySuggestions(e,c,i,u,l,v,m))}else i.parent&&s.push(t.getSchemaLessPropertySuggestions(c,i,m))}if(i&&("string"===i.type||"number"===i.type||"boolean"===i.type||"null"===i.type)){var h=r.getRangeFromOffsetAndLength(i.start,i.end-i.start);d.overwriteBefore=n.column-h.startColumn,d.overwriteAfter=h.endColumn-n.column,i=i.parent}return e?s.push(t.getValueSuggestions(e,c,i,a,m)):s.push(t.getSchemaLessValueSuggestions(c,i,a,r,m)),o.Promise.join(s).then(function(){return d})})},e.prototype.getPropertySuggestions=function(e,r,s,n,t,a,i){var l=this,c=[];r.validate(e.schema,c,s.start);var d=[];return c.forEach(function(e){if(e.node===s&&!e.inverted){var r=e.schema.properties;r&&Object.keys(r).forEach(function(e){var s=r[e];i.add({type:"property",label:e,codeSnippet:l.getSnippetForProperty(e,s,t,a),documentationLabel:s.description||""})});var o=e.schema.id;o&&l.contributions.forEach(function(e){d.push(e.collectPropertySuggestions(o,n,t,a,i))})}}),o.Promise.join(d)},e.prototype.getSchemaLessPropertySuggestions=function(e,r,s){var n=this,t=function(e){e.properties.forEach(function(e){var r=e.key.value;s.add({type:"property",label:r,codeSnippet:n.getSnippetForSimilarProperty(r,e.value),documentationLabel:""})})};if("property"===r.parent.type){var a=r.parent.key.value;e.visit(function(e){return"property"===e.type&&e.key.value===a&&e.value&&"object"===e.value.type&&t(e.value),!0})}else"array"===r.parent.type&&r.parent.items.forEach(function(e){"object"===e.type&&e!==r&&t(e)});return o.Promise.as(0)},e.prototype.getSchemaLessValueSuggestions=function(e,r,s,n,t){var a=this,i=function(e){var r=a.getMatchingSnippet(e,n);t.add({type:a.getSuggestionType(e.type),label:r,codeSnippet:r,documentationLabel:""}),"boolean"===e.type&&a.addBooleanSuggestion(!e.getValue(),t)};if(r){if("property"===r.type&&s>r.colonOffset){var l=r.value;if(l&&s>l.end)return;var c=r.key.value;e.visit(function(e){return"property"===e.type&&e.key.value===c&&e.value&&i(e.value),!0})}if("array"===r.type)if(r.parent&&"property"===r.parent.type){var c=r.parent.key.value;e.visit(function(e){return"property"===e.type&&e.key.value===c&&e.value&&"array"===e.value.type&&e.value.items.forEach(function(e){i(e)}),!0})}else r.items.forEach(function(e){i(e)})}else t.add({type:this.getSuggestionType("object"),label:"Empty object",codeSnippet:"{\n	{{}}\n}",documentationLabel:""}),t.add({type:this.getSuggestionType("array"),label:"Empty array",codeSnippet:"[\n	{{}}\n]",documentationLabel:""});return o.Promise.as(0)},e.prototype.getValueSuggestions=function(e,r,s,n,t){var a=this,i=[];if(s){var l=null;if(s&&"property"===s.type&&n>s.colonOffset){var c=s.value;if(c&&n>c.end)return o.Promise.as(0);l=s.key.value,s=s.parent}if(s&&(null!==l||"array"===s.type)){var d=[];r.validate(e.schema,d,s.start),d.forEach(function(e){var r=null,n="string";if(e.node===s&&!e.inverted&&e.schema){if("array"===s.type&&e.schema.items)r=e.schema.items.enum,n=e.schema.items.type,a.addDefaultSuggestion(e.schema.items,t);else if(e.schema.properties){var o=e.schema.properties[l];o&&(r=o.enum,n=o.type,a.addDefaultSuggestion(o,t))}if(Array.isArray(r))for(var c=0;c<r.length;c++){var d=a.getSnippetForValue(r[c]);t.add({type:a.getSuggestionType(n),label:a.getLabelForValue(r[c]),codeSnippet:d,documentationLabel:""})}else"boolean"===n&&(a.addBooleanSuggestion(!0,t),a.addBooleanSuggestion(!1,t));var u=e.schema.id;u&&a.contributions.forEach(function(e){i.push(e.collectValueSuggestions(u,l,t))})}})}}else this.contributions.forEach(function(r){i.push(r.collectDefaultSuggestions(e.schema.id,t))}),this.addDefaultSuggestion(e.schema,t);return o.Promise.join(i)},e.prototype.addBooleanSuggestion=function(e,r){var s=e?"true":"false";r.add({type:this.getSuggestionType("boolean"),label:s,codeSnippet:s,documentationLabel:""})},e.prototype.addDefaultSuggestion=function(e,r){e.default&&r.add({type:this.getSuggestionType(e.type),label:t.localize("vs_languages_json_jsonIntellisense",0),codeSnippet:this.getSnippetForValue(e.default),documentationLabel:this.getLabelForValue(e.default)})},e.prototype.getLabelForValue=function(e){var r=JSON.stringify(e);return r.length>50?r.substr(0,50).trim()+"...":r},e.prototype.getSnippetForValue=function(e){var r=JSON.stringify(e,null,"	");switch(typeof e){case"object":return r;case"string":return'"{{'+r.substr(1,r.length-2)+'}}"';case"number":return"{{"+r+"}}"}return r},e.prototype.getSuggestionType=function(e){if(Array.isArray(e)){var r=e;e=r.length>0?r[0]:null}if(!e)return"text";switch(e){case"string":return"text";case"object":return"module";case"property":return"property";default:return"value"}},e.prototype.getMatchingSnippet=function(e,r){switch(e.type){case"array":return"[]";case"object":return"{}";default:var s=r.getValueInRange(r.getRangeFromOffsetAndLength(e.start,e.end-e.start));return s}},e.prototype.getSnippetForProperty=function(e,r,s,o){var t='"'+e+'"';if(!s)return t;t+=": ";var a=r.default;if(n.isUndefined(a))if(r.enum&&r.enum.length>0)t+=this.getSnippetForValue(r.enum[0]);else switch(r.type){case"boolean":t+="{{false}}";break;case"string":t+='"{{}}"';break;case"object":t+="{\n	{{}}\n}";break;case"array":t+="[\n	{{}}\n]";break;case"number":t+="{{0}}";break;default:return t}else t+=this.getSnippetForValue(a);return o||(t+=","),t},e.prototype.getSnippetForSimilarProperty=function(e){return'"'+e+'"'},e}();r.JSONIntellisense=a}),define("vs/languages/json/contributions/projectJSONContribution",["require","exports","vs/base/lib/winjs.base","vs/nls!vs/languages/json/jsonWorker"],function(e,r,s,n){var o=function(){function e(e){this.requestService=e.requestService}return e.prototype.collectDefaultSuggestions=function(e,r){if("http://json.schemastore.org/project"===e){var o={version:"{{1.0.0-*}}",dependencies:{},frameworks:{aspnet50:{},aspnetcore50:{}}};r.add({type:"type",label:n.localize("vs_languages_json_contributions_projectJSONContribution",0),codeSnippet:JSON.stringify(o,null,"	"),documentationLabel:""})}return s.Promise.as(0)},e.prototype.collectPropertySuggestions=function(e,r,n,o,t){if("nugget-packages"===e){var a;return a=r.length>0?"https://www.myget.org/F/aspnetrelease/api/v2/Packages?$filter=Id%20ge%20'"+encodeURIComponent(r)+"'%20and%20Id%20lt%20'"+encodeURIComponent(r+"z")+"'%20and%20IsAbsoluteLatestVersion%20eq%20true&$select=Id,Version,Description&$format=json&$top=100":"https://www.myget.org/F/aspnetrelease/api/v2/Packages?$filter=IsAbsoluteLatestVersion%20eq%20true&$orderby=DownloadCount%20desc&$top=100&$select=Id,Version,DownloadCount,Description&$format=json",this.requestService.makeRequest({url:a}).then(function(e){try{var r=JSON.parse(e.responseText);if(Array.isArray(r.d))for(var s=r.d,a=0;a<s.length;a++){var i=s[a],l=i.Id,c=i.Version;if(l){var d=i.Description,u=i.Version,m=JSON.stringify(l);n&&(m+=': "{{'+c+'}}"',o||(m+=",")),t.add({type:"property",label:l,codeSnippet:m,typeLabel:u,documentationLabel:d})}}}catch(h){}},function(){return 0})}return s.Promise.as(0)},e.prototype.collectValueSuggestions=function(e,r,o){if("nugget-packages"===e){var t="https://www.myget.org/F/aspnetrelease/api/v2/Packages?$filter=Id%20eq%20'"+encodeURIComponent(r)+"'&$select=Version,IsAbsoluteLatestVersion&$format=json&$top=50";return this.requestService.makeRequest({url:t}).then(function(e){try{var r=JSON.parse(e.responseText);if(Array.isArray(r.d))for(var s=r.d,t=0;t<s.length;t++){var a=s[t],i=a.Version;if(i){var l=JSON.stringify(i),c="true"===a.IsAbsoluteLatestVersion,d=l,u="";c&&(u=n.localize("vs_languages_json_contributions_projectJSONContribution",1)),o.add({type:"class",label:d,codeSnippet:l,documentationLabel:u})}}}catch(m){}return 0},function(){return 0})}return s.Promise.as(0)},e.prototype.getInfoContribution=function(e,r){if("nugget-package"===e){var s=[];s.push({className:"type",text:n.localize("vs_languages_json_contributions_projectJSONContribution",2,r)});var o="https://www.myget.org/F/aspnetrelease/api/v2/Packages?$filter=Id%20eq%20'"+encodeURIComponent(r)+"'%20and%20IsAbsoluteLatestVersion%20eq%20true&$select=Version,Description&$format=json&$top=5";return this.requestService.makeRequest({url:o}).then(function(e){var r=e.responseText;if(r)try{var o=JSON.parse(r);if(o.d&&o.d[0]){var t=o.d[0];t.Description&&s.push({className:"documentation",text:t.Description}),t.Version&&s.push({className:"documentation",text:n.localize("vs_languages_json_contributions_projectJSONContribution",3,t.Version)})}}catch(a){}return s},function(){return s})}return null},e}();r.ProjectJSONContribution=o}),define("vs/languages/json/contributions/packageJSONContribution",["require","exports","vs/base/lib/winjs.base","vs/nls!vs/languages/json/jsonWorker"],function(e,r,s,n){var o=function(){function e(e){this.requestService=e.requestService}return e.prototype.collectDefaultSuggestions=function(e,r){if("http://json.schemastore.org/package"===e){var o={name:"{{name}}",description:"{{description}}",author:"{{author}}",version:"{{1.0.0}}",main:"{{pathToMain}}",dependencies:{}};r.add({type:"type",label:n.localize("vs_languages_json_contributions_packageJSONContribution",0),codeSnippet:JSON.stringify(o,null,"	"),documentationLabel:""})}return s.Promise.as(0)},e.prototype.collectPropertySuggestions=function(e,r,n,o,t){if("npm-packages"===e){var a;return a=r.length>0?"https://typeahead.npmjs.com/search?q="+encodeURIComponent(r):"https://typeahead.npmjs.com/search?q=",this.requestService.makeRequest({url:a}).then(function(e){try{var r=JSON.parse(e.responseText);if(Array.isArray(r))for(var s=r,a=0;a<s.length;a++){var i=s[a].value,l=JSON.stringify(i);n&&(l+=': "{{*}}"',o||(l+=",")),t.add({type:"property",label:i,codeSnippet:l,documentationLabel:""})}}catch(c){}t.setAsIncomplete()},function(){return 0})}return s.Promise.as(0)},e.prototype.collectValueSuggestions=function(e,r,n){if("npm-packages"===e){var o="http://registry.npmjs.org/"+encodeURIComponent(r)+"/latest";return this.requestService.makeRequest({url:o}).then(function(e){try{var r=JSON.parse(e.responseText);if(r&&r.version){var s=r.version,o=JSON.stringify(s);n.add({type:"class",label:o,codeSnippet:o,documentationLabel:"The currently latest version of the package"}),o=JSON.stringify("^"+s),n.add({type:"class",label:o,codeSnippet:o,documentationLabel:"Matches the most recent major version (1.x.x)"}),o=JSON.stringify("~"+s),n.add({type:"class",label:o,codeSnippet:o,documentationLabel:"Matches the most recent minor version (1.2.x)"})}}catch(t){}return 0},function(){return 0})}return s.Promise.as(0)},e.prototype.getInfoContribution=function(e,r){if("npm-package"===e){var s=[];s.push({className:"type",text:n.localize("vs_languages_json_contributions_packageJSONContribution",1,r)});var o="http://registry.npmjs.org/"+encodeURIComponent(r)+"/latest";return this.requestService.makeRequest({url:o}).then(function(e){try{var r=JSON.parse(e.responseText);r&&(r.description&&s.push({className:"documentation",text:r.description}),r.version&&s.push({className:"documentation",text:n.localize("vs_languages_json_contributions_packageJSONContribution",2,r.version)}))}catch(o){}return s},function(){return s})}return null},e}();r.PackageJSONContribution=o}),define("vs/languages/json/contributions/bowerJSONContribution",["require","exports","vs/base/strings","vs/base/lib/winjs.base","vs/nls!vs/languages/json/jsonWorker"],function(e,r,s,n,o){var t=function(){function e(e){this.topRanked=["twitter","bootstrap","angular-1.1.6","angular-latest","angulerjs","d3","myjquery","jq","abcdef1234567890","jQuery","jquery-1.11.1","jquery","sushi-vanilla-x-data","font-awsome","Font-Awesome","font-awesome","fontawesome","html5-boilerplate","impress.js","homebrew","backbone","moment1","momentjs","moment","linux","animate.css","animate-css","reveal.js","jquery-file-upload","blueimp-file-upload","threejs","express","chosen","normalize-css","normalize.css","semantic","semantic-ui","Semantic-UI","modernizr","underscore","underscore1","material-design-icons","ionic","chartjs","Chart.js","nnnick-chartjs","select2-ng","select2-dist","phantom","skrollr","scrollr","less.js","leancss","parser-lib","hui","bootstrap-languages","async","gulp","jquery-pjax","coffeescript","hammer.js","ace","leaflet","jquery-mobile","sweetalert","typeahead.js","soup","typehead.js","sails","codeigniter2"],this.requestService=e.requestService}return e.prototype.collectDefaultSuggestions=function(e,r){if("http://json.schemastore.org/bower"===e){var s={name:"{{name}}",description:"{{description}}",author:"{{author}}",version:"{{1.0.0}}",main:"{{pathToMain}}",dependencies:{}};r.add({type:"type",label:o.localize("vs_languages_json_contributions_bowerJSONContribution",0),codeSnippet:JSON.stringify(s,null,"	"),documentationLabel:""})}return n.Promise.as(0)},e.prototype.collectPropertySuggestions=function(e,r,s,o,t){if("bower-packages"===e){if(r.length>0){var a="https://bower.herokuapp.com/packages/search/"+encodeURIComponent(r);return this.requestService.makeRequest({url:a}).then(function(e){try{var r=JSON.parse(e.responseText);if(Array.isArray(r))for(var n=r,a=0;a<n.length;a++){var i=n[a].name,l=n[a].description||"",c=JSON.stringify(i);s&&(c+=': "{{*}}"',o||(c+=",")),t.add({type:"property",label:i,codeSnippet:c,documentationLabel:l})}}catch(d){}},function(){return 0})}this.topRanked.forEach(function(e){var r=JSON.stringify(e);s&&(r+=': "{{*}}"',o||(r+=",")),t.add({type:"property",label:e,codeSnippet:r,documentationLabel:""})})}return n.Promise.as(0)},e.prototype.collectValueSuggestions=function(){return n.Promise.as(0)},e.prototype.getInfoContribution=function(e,r){if("bower-package"===e){var n=[];n.push({className:"type",text:o.localize("vs_languages_json_contributions_bowerJSONContribution",1,r)});var t="https://bower.herokuapp.com/packages/"+encodeURIComponent(r);return this.requestService.makeRequest({url:t}).then(function(e){try{var r=JSON.parse(e.responseText);if(r&&r.url){var o=r.url;s.startsWith(o,"git://")&&(o=o.substring(6)),s.endsWith(o,".git")&&(o=o.substring(0,o.length-4)),n.push({className:"documentation",text:o})}}catch(t){}return n},function(){return n})}return null},e}();r.BowerJSONContribution=t});var __extends=this.__extends||function(e,r){function s(){this.constructor=e}for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]);s.prototype=r.prototype,e.prototype=new s};define("vs/languages/json/jsonWorker",["require","exports","vs/base/severity","vs/editor/worker/modesWorker","./parser/jsonParser","./jsonSchemaService","./jsonIntellisense","vs/base/lib/winjs.base","vs/base/strings","./contributions/projectJSONContribution","vs/editor/modes/supports","./contributions/packageJSONContribution","./contributions/bowerJSONContribution"],function(e,r,s,n,o,t,a,i,l,c,d,u,m){var h=function(e){function r(r,s,n){e.call(this,r,s,n),this.jsonMode=s,this.requestService=r.requestService,this.schemaService=new t.JSONSchemaService(r),this.contributions=[r.instantiationService.createInstance(c.ProjectJSONContribution),r.instantiationService.createInstance(u.PackageJSONContribution),r.instantiationService.createInstance(m.BowerJSONContribution)],this.jsonIntellisense=new a.JSONIntellisense({schemaService:this.schemaService,requestService:this.requestService},this.contributions)}return __extends(r,e),r.prototype._createInPlaceReplaceSupport=function(){return new d.InplaceReplaceSupport(this.resourceService,this)},r.prototype._doConfigure=function(e){var r=this;return e&&e.schemas&&(this.schemaService.clearExternalSchemas(),e.schemas.forEach(function(e){if(e.url&&(e.fileMatch||e.schema)){var s=e.url,n=!1;l.startsWith(s,"http://")||l.startsWith(s,"https://")||(s=r.requestService.getRequestUrl("root",s,!0),n=!0);var o=null;if(e.fileMatch){o=[];for(var t=0;t<e.fileMatch.length;t++)try{o.push(new RegExp(l.convertSimple2RegExpPattern(e.fileMatch[t])))}catch(a){}}r.schemaService.registerExternalSchema(s,o,e.schema)}else if(e.filePattern&&e.schemaPath){var s=r.requestService.getRequestUrl("root",e.schemaPath),o=[];try{o.push(new RegExp(e.filePattern))}catch(a){}r.schemaService.registerExternalSchema(s,o)}})),i.TPromise.as(!0)},r.prototype.setConfigurationSchemas=function(e){return this.schemaService.setConfigurationSchemas(e),i.TPromise.as(!0)},r.prototype.doValidate=function(e){var r=this,n=this.resourceService.get(e),t=new o.JSONParser,a=n.getValue();if(0!==a.length){var i=t.parse(a);this.schemaService.getSchemaForResource(e.toString(),i).then(function(o){if(o)if(o.loadError&&i.root){var t="object"===i.root.type?i.root.getFirstProperty("$schema"):null;if(t){var a=t.value||t;i.warnings.push({location:{start:a.start,end:a.end},message:o.loadError})}else i.warnings.push({location:{start:i.root.start,end:i.root.start+1},message:o.loadError})}else i.validate(o.schema);var l=i.errors.concat(i.warnings).map(function(e,r){var o=n.getPositionFromOffset(e.location.start),t=n.getPositionFromOffset(e.location.end);return{message:e.message,severity:r>=i.errors.length?s.Warning:s.Error,startLineNumber:o.lineNumber,startColumn:o.column,endLineNumber:t.lineNumber,endColumn:t.column}});r.markerService.changeOne(r._getMode().getId(),e,l)})}},r.prototype.doSuggest=function(e,r){var s=this.resourceService.get(e);return this.jsonIntellisense.doSuggest(e,s,r)},r.prototype.computeInfo=function(e,r){var s=this,n=this.resourceService.get(e),t=new o.JSONParser,a=t.parse(n.getValue()),l=n.getOffsetFromPosition(r),c=a.getNodeFromOffset(l),d=c;if(c&&"string"===c.type){var u=c;if(u.isKey){var m=c.parent;c=m.value}}return c?this.schemaService.getSchemaForResource(e.toString(),a).then(function(e){if(e){var r=[];a.validate(e.schema,r,c.start);var o=null,t=null;if(r.every(function(e){return e.node===c&&!e.inverted&&e.schema&&(o=o||e.schema.description,t=t||e.schema.id),!0}),t&&c.name)for(var i=s.contributions.length-1;i>=0;i--){var l=s.contributions[i],u=l.getInfoContribution(t,c.name);if(u)return u.then(function(e){return s.createInfoResult(e,d,n)})}if(o){var m=[{className:"documentation",text:o}];return s.createInfoResult(m,d,n)}}return null}):i.Promise.as(null)},r.prototype.createInfoResult=function(e,r,s){var n=s.getRangeFromOffsetAndLength(r.start,r.end-r.start),o={value:"",htmlContent:e,className:"typeInfo json",range:n};return o},r.prototype.getOutline=function(e){function r(e,n){if("array"===n.type)n.items.forEach(function(s){r(e,s)});else if("object"===n.type){var o=n;o.properties.forEach(function(n){var o=s.getRangeFromOffsetAndLength(n.start,n.end-n.start),t=n.value;if(t){var a=r([],t),i="object"===t.type?"module":t.type;e.push({label:n.key.getValue(),icon:i,type:t.type,range:o,children:a})}})}return e}var s=this.resourceService.get(e),n=new o.JSONParser,t=n.parse(s.getValue()),a=t.root;if(!a)return i.Promise.as(null);var c=e.toString();if(("inmemory:/.keybindings/defaults.json"===c||l.endsWith(c.toLowerCase(),"/user/keybindings.json"))&&"array"===a.type){var d=[];return a.items.forEach(function(e){if("object"===e.type){var r=e.getFirstProperty("key");if(r&&r.value){var n=s.getRangeFromOffsetAndLength(e.start,e.end-e.start);d.push({label:r.value.getValue(),icon:"function",type:"string",range:n,children:[]})}}}),i.Promise.as(d)}var d=r([],a);return i.Promise.as(d)},r.prototype.textReplace=function(e,r){return d.ReplaceSupport.valueSetReplace(["true","false"],e,r)},r.prototype.format=function(e,r,s){var n=this.resourceService.get(e),o=r?n.getValueInRange(r):n.getValue(),t=4;t=s.insertSpaces?s.tabSize:"	";try{return i.TPromise.as([{range:r,text:JSON.stringify(JSON.parse(o),null,t)}])}catch(a){return null}},r.prototype.navigateValueSetFallback=function(e,r,s){var n=this,t=this.resourceService.get(e),a=t.getOffsetFromPosition({lineNumber:r.startLineNumber,column:r.startColumn}),i=new o.JSONParser,c=new o.JSONDocumentConfig;c.ignoreDanglingComma=!0;var d=i.parse(t.getValue(),c),u=d.getNodeFromOffsetEndInclusive(a);return!u||"string"!==u.type&&"number"!==u.type&&"boolean"!==u.type&&"null"!==u.type?null:this.schemaService.getSchemaForResource(e.toString(),d).then(function(e){if(e){var r=[],o={},a={add:function(e){o[e.label]||(o[e.label]=!0,r.push(e))},setAsIncomplete:function(){}};return n.jsonIntellisense.getValueSuggestions(e,d,u.parent,u.start,a).then(function(){for(var e=t.getRangeFromOffsetAndLength(u.start,u.end-u.start),n=t.getValueInRange(e),o=0,a=r.length;a>o;o++)if(l.equalsIgnoreCase(r[o].label,n)){var i=o;return s?i=(o+1)%a:(i=o-1,0>i&&(i=a-1)),{value:r[i].label,range:e}}return null})}})},r}(n.AbstractWorkerMode);r.JSONWorker=h});